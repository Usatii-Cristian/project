<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FunCasino - Toate jocurile</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #111;
      color: #fff;
      line-height: 1.6;
    }
    .container {
      max-width: 1000px;
      margin: 20px auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      position: relative;
    }
    header {
      text-align: center;
      margin-bottom: 20px;
      display: flex; /* Adăugat pentru aliniere */
      justify-content: space-between; /* Spațiere între titlu și buton */
      align-items: center; /* Aliniere verticală */
    }
    header h1 {
      color: #ffcc00;
      font-size: 2.5em;
      margin: 0; /* Elimină marginile implicite */
    }
    /* Stil pentru butonul Home */
    #home-btn {
      background: #444;
      color: white;
      border: none;
      padding: 10px 15px;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
      transition: 0.3s;
    }
    #home-btn:hover {
      background: #666;
    }
    /* Meniu de jocuri pe dreapta */
    .game-menu-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 100;
    }

    .menu-toggle-btn {
        background: #ff4444;
        color: white;
        border: none;
        padding: 15px 25px; /* Mărit padding-ul */
        font-size: 18px; /* Mărit fontul */
        border-radius: 10px;
        cursor: pointer;
        transition: 0.3s;
        width: 100%; /* Butonul toggle ocupă întreaga lățime a containerului */
    }

    .menu-toggle-btn:hover {
        background: #ff6666;
    }

    .game-selector-sidebar {
        display: none; /* Ascuns implicit */
        flex-direction: column;
        gap: 15px; /* Spatiu mai mare între butoane */
        margin-top: 10px;
        background: rgba(34, 34, 34, 0.95);
        padding: 20px; /* Padding mai mare */
        border-radius: 10px;
        min-width: 200px; /* Lățime minimă pentru meniu */
    }

    .game-selector-sidebar button {
        background: #444;
        color: white;
        border: none;
        padding: 12px 20px; /* Padding mai mare */
        font-size: 16px; /* Font mai mare */
        border-radius: 8px;
        cursor: pointer;
        transition: 0.3s;
        text-align: left; /* Aliniere text la stânga */
        width: 100%; /* Butoanele ocupă întreaga lățime */
    }

    .game-selector-sidebar button:hover {
        background: #666;
    }
    .game-selector-sidebar button.active {
        background: #ff4444;
    }
    .game { display: none; }
    .active-game { display: block !important; }
    .game h2 { color: #ffcc00; margin-bottom: 15px; text-align: center; }
    footer {
      margin-top: auto;
      text-align: center;
      padding: 20px 0;
      color: #888;
      font-size: 0.9em;
    }
    .stats {
      display: flex;
      justify-content: space-between;
      background: #222;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .stat-item {
      text-align: center;
      flex: 1;
      min-width: 120px;
      margin: 5px;
    }
    .stat-value {
      font-size: 1.8em;
      font-weight: bold;
      color: #ffcc00;
    }
    .stat-label {
      font-size: 0.9em;
      color: #aaa;
    }
    .message {
      background: #222;
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      text-align: center;
      min-height: 20px;
    }
    .bet-controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
      flex-wrap: wrap;
    }
    .bet-controls button {
      background: #444;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      transition: 0.3s;
    }
    .bet-controls button:hover {
      background: #666;
    }
    .bet-controls button.active {
      background: #ff4444;
    }
    .custom-bet {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .custom-bet input {
      width: 80px;
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #444;
      background: #222;
      color: white;
    }
    .custom-bet button {
      background: #ff4444;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
    }
    /* - Sloturi - */
    .slots-machine {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 20px 0;
    }
    .slot {
      width: 80px;
      height: 80px;
      background: #222;
      border-radius: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 2.5em;
      border: 2px solid #444;
    }
    #spin {
      display: block;
      margin: 20px auto;
      padding: 12px 30px;
      font-size: 1.2em;
      background: #ff4444;
      color: white;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      transition: 0.3s;
    }
    #spin:hover {
      background: #ff6666;
    }
    #spin:disabled {
      background: #555;
      cursor: not-allowed;
    }
    /* - Plinko - */
    .plinko-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 20px 0;
    }
    #plinko-board {
      position: relative;
      width: 300px;
      height: 500px;
      background: #222;
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 10px;
    }
    .peg {
      position: absolute;
      width: 10px;
      height: 10px;
      background: #555;
      border-radius: 50%;
    }
    .ball {
      position: absolute;
      width: 15px;
      height: 15px;
      background: #ffcc00;
      border-radius: 50%;
    }
    #plinko-slots {
      display: flex;
      width: 100%;
      justify-content: space-around;
      gap: 2px; /* Redus gap pentru cifre mai strânse */
    }
    #plinko-slots div {
      width: 30px; /* Redus lățime */
      text-align: center;
      font-weight: bold;
      font-size: 0.9em; /* Redus font-size */
    }
    .plinko-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
      margin: 15px 0;
      align-items: center;
    }
    .plinko-controls input {
      width: 60px;
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #444;
      background: #222;
      color: white;
    }
    #drop {
      padding: 12px 25px;
      font-size: 1.1em;
      background: #ff4444;
      color: white;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      transition: 0.3s;
    }
    #drop:hover {
      background: #ff6666;
    }
    #drop:disabled {
      background: #555;
      cursor: not-allowed;
    }
    /* - Crush - */
    .crush-container {
      text-align: center;
      margin: 20px 0;
    }
    #multiplier-display {
      font-size: 3em;
      font-weight: bold;
      color: #ffcc00;
      margin: 20px 0;
    }
    #plane {
      font-size: 4em;
      transition: transform 0.1s linear;
      margin: 20px 0;
    }
    #explosion {
      font-size: 4em;
      color: #ff4444;
      display: none;
      margin: 20px 0;
    }
    .crush-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }
    .crush-buttons button {
      padding: 12px 25px;
      font-size: 1.1em;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      transition: 0.3s;
    }
    #start-crush {
      background: #44ff44;
      color: #000;
    }
    #start-crush:hover {
      background: #66ff66;
    }
    #start-crush:disabled {
      background: #555;
      cursor: not-allowed;
    }
    #cash-out {
      background: #ffcc00;
      color: #000;
    }
    #cash-out:hover {
      background: #ffdd33;
    }
    #cash-out:disabled {
      background: #555;
      cursor: not-allowed;
    }
    /* - Tower - */
    .difficulty {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
    }
    .difficulty button {
      padding: 8px 15px;
      background: #444;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .difficulty button:hover {
      background: #666;
    }
    .difficulty button.active {
      background: #ff4444;
    }
    #tower-grid {
      display: grid;
      gap: 3px; /* Redus gap */
      margin: 15px auto; /* Redus margin */
      max-width: 250px; /* Redus max-width */
    }
    .tower-cell {
      aspect-ratio: 1;
      background: #222;
      border-radius: 3px; /* Redus border-radius */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.2em; /* Redus font-size */
      cursor: pointer;
      transition: 0.3s;
      width: 30px; /* Fixat lățime */
      height: 30px; /* Fixat înălțime */
    }
    .tower-cell:hover {
      background: #333;
    }
    .tower-cell.bomb {
      background: #ff4444;
    }
    .tower-cell.safe {
      background: #44ff44;
    }
    .tower-cell.bonus {
      background: #ffcc00;
    }
    #start-tower {
      display: block;
      margin: 15px auto; /* Redus margin */
      padding: 10px 25px; /* Redus padding */
      font-size: 1em; /* Redus font-size */
      background: #ff4444;
      color: white;
      border: none;
      border-radius: 30px;
      cursor: pointer;
    }
    #start-tower:hover {
      background: #ff6666;
    }
    /* - Miner - */
    .bombs-select {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
    }
    .bombs-select button {
      padding: 8px 15px;
      background: #444;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .bombs-select button:hover {
      background: #666;
    }
    .bombs-select button.active {
      background: #ff4444;
    }
    #miner-grid {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 5px;
      margin: 20px auto;
      max-width: 300px;
    }
    .miner-cell {
      aspect-ratio: 1;
      background: #222;
      border-radius: 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.5em;
      cursor: pointer;
      transition: 0.3s;
    }
    .miner-cell:hover {
      background: #333;
    }
    .miner-cell.bomb {
      background: #ff4444;
    }
    .miner-cell.safe {
      background: #44ff44;
    }
    .miner-cell.disabled {
        pointer-events: none;
        opacity: 0.5;
    }
    #start-miner, #cash-out-miner {
      padding: 10px 20px;
      margin: 10px;
      background: #ff4444;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #start-miner:hover, #cash-out-miner:hover {
      background: #ff6666;
    }
    #cash-out-miner:disabled {
      background: #555;
      cursor: not-allowed;
    }
    .miner-controls {
      display: flex;
      justify-content: center;
    }
    /* - Crossy - */
    #crossy-path {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
      min-height: 50px; /* Asigură un spațiu minim */
    }
    #crossy-path div {
      font-size: 2em;
    }
    .crossy-controls {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }
    .crossy-controls button {
      padding: 12px 25px;
      font-size: 1.1em;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      transition: 0.3s;
    }
    #left-btn, #right-btn {
      background: #444;
      color: white;
    }
    #left-btn:hover, #right-btn:hover {
      background: #666;
    }
    #left-btn:disabled, #right-btn:disabled {
      background: #555;
      cursor: not-allowed;
    }
    #start-crossy {
      display: block;
      margin: 20px auto;
      padding: 12px 30px;
      font-size: 1.1em;
      background: #ff4444;
      color: white;
      border: none;
      border-radius: 30px;
      cursor: pointer;
    }
    #start-crossy:hover {
      background: #ff6666;
    }
    #start-crossy:disabled {
      background: #555;
      cursor: not-allowed;
    }
    /* - BlackJack - */
    #blackjack {
      text-align: center;
    }
    #blackjack h2 {
       margin-top: 0; /* Elimină marginea de sus pentru titlul jocului */
    }
    #dealer-cards, #player-cards {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
      min-height: 100px; /* Asigură spațiu pentru cărți */
    }
    .card {
      width: 60px;
      height: 90px;
      border: 1px solid #333;
      border-radius: 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      font-weight: bold;
      background-color: #fff;
      color: #000;
    }
    .hidden-card {
      background-color: #555;
      color: #555;
    }
    #bj-controls {
      margin: 20px 0;
    }
    #bj-controls button {
      padding: 10px 20px;
      margin: 0 10px;
      font-size: 1em;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #bj-hit { background: #444; color: white; }
    #bj-stand { background: #666; color: white; }
    #bj-deal { background: #ff4444; color: white; }
    #bj-hit:hover, #bj-stand:hover { background: #888; }
    #bj-deal:hover { background: #ff6666; }
    #bj-hit:disabled, #bj-stand:disabled, #bj-deal:disabled {
      background: #555;
      cursor: not-allowed;
    }
    /* - Poker - */
    #poker {
      text-align: center;
    }
    #poker h2 {
       margin-top: 0;
    }
    #poker-cards {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin: 20px 0;
      min-height: 100px;
    }
    #poker-message {
      margin: 10px 0;
      min-height: 20px;
      color: #ffcc00;
    }
    #poker-controls {
      margin: 20px 0;
    }
    #poker-controls button {
      padding: 10px 20px;
      margin: 0 10px;
      font-size: 1em;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #deal-poker { background: #ff4444; color: white; }
    #deal-poker:hover { background: #ff6666; }
    #deal-poker:disabled { background: #555; cursor: not-allowed; }
    #draw-poker { background: #444; color: white; }
    #draw-poker:hover { background: #666; }
    #draw-poker:disabled { background: #555; cursor: not-allowed; }
    /* Istoric Crush */
    #crush-history {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 5px;
      margin-top: 10px;
    }
    .history-item {
      padding: 5px 10px;
      background: #333;
      border-radius: 5px;
      font-size: 0.9em;
    }
    .history-item.crash {
      background: #ff4444;
    }
    /* Responsiv */
    @media (max-width: 600px) {
      .container {
        padding: 10px;
      }
      header h1 {
        font-size: 1.8em;
      }
      .stats {
        flex-direction: column;
      }
      .stat-item {
        margin: 10px 0;
      }
      .slots-machine {
        gap: 5px;
      }
      .slot {
        width: 60px;
        height: 60px;
        font-size: 2em;
      }
      #plinko-board {
        width: 250px;
        height: 400px;
      }
      .crossy-controls {
        flex-direction: column;
        align-items: center;
      }
      .crossy-controls button {
        width: 80%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>🎲 FunCasino</h1>
      <button id="home-btn">🏠 Home</button>
    </header>

    <div class="stats">
      <div class="stat-item">
        <div class="stat-value" id="coins">1000</div>
        <div class="stat-label">Monede</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="bet">10</div>
        <div class="stat-label">Pariu Curent</div>
      </div>
    </div>

    <div class="message" id="message">Bun venit la FunCasino! Alege un joc.</div>

    <div class="bet-controls">
      <button onclick="setBet(10)">10</button>
      <button onclick="setBet(50)">50</button>
      <button onclick="setBet(100)">100</button>
      <button onclick="setBet(500)">500</button>
      <div class="custom-bet">
        <input type="number" id="custom-bet" placeholder="Alt pariU" min="1" max="10000">
        <button onclick="applyCustomBet()">Aplică</button>
      </div>
    </div>

    <!-- Meniu de Selectare Jocuri -->
    <div class="game-menu-container">
      <button class="menu-toggle-btn" onclick="toggleGameMenu()">☰ Jocuri</button>
      <div class="game-selector-sidebar" id="game-sidebar">
        <button onclick="switchGame('slots')">🎰 Sloturi</button>
        <button onclick="switchGame('plinko')">🔴 Plinko</button>
        <button onclick="switchGame('crush')">🚀 Crush</button>
        <button onclick="switchGame('tower')">🗼 Tower</button>
        <button onclick="switchGame('miner')">⛏️ Miner</button>
        <button onclick="switchGame('crossy')">🐸 Crossy</button>
        <button onclick="switchGame('blackjack')">🃏 BlackJack</button>
        <button onclick="switchGame('poker')">🃟 Poker</button> <!-- Adăugat -->
      </div>
    </div>

    <!-- JOC SLOTURI -->
    <div id="slots" class="game active-game">
      <h2>🎰 Sloturi Norocoase</h2>
      <div class="slots-machine">
        <div class="slot" id="r1">🍒</div>
        <div class="slot" id="r2">🍋</div>
        <div class="slot" id="r3">🍉</div>
      </div>
      <button id="spin">Învârte! (Cost: <span id="spin-cost">10</span>)</button>
    </div>

    <!-- JOC PLINKO -->
    <div id="plinko" class="game">
      <h2>🔴 Plinko</h2>
      <div class="plinko-container">
        <div id="plinko-board"></div>
        <div id="plinko-slots"></div>
      </div>
      <div class="plinko-controls">
        <label>Bile: <input type="number" id="plinko-balls" value="1" min="1" max="10"></label>
        <button onclick="applyPlinkoBalls()">Aplică</button>
        <button id="drop">Drop (Cost: <span id="drop-cost">5</span>/bila)</button>
      </div>
    </div>

    <!-- JOC CRUSH -->
    <div id="crush" class="game">
      <h2>🚀 Crush</h2>
      <div class="crush-container">
        <div id="multiplier-display">1.000x</div>
        <div id="plane">✈️</div>
        <div id="explosion">💥</div>
        <div class="crush-buttons">
          <button id="start-crush">Start Crush (Cost: <span id="crush-cost">10</span>)</button>
          <button id="cash-out" disabled>Cash Out</button>
        </div>
        <div>Istoric explozii:</div>
        <div id="crush-history"></div>
      </div>
    </div>

    <!-- JOC TOWER -->
    <div id="tower" class="game">
      <h2>🗼 Tower</h2>
      <div class="difficulty">
        <button onclick="setTowerDiff('easy')" class="active">Ușor (3 coloane)</button>
        <button onclick="setTowerDiff('medium')">Mediu (4 coloane)</button>
        <button onclick="setTowerDiff('hard')">Greu (5 coloane)</button>
      </div>
      <div id="tower-grid"></div>
      <button id="start-tower">Start Tower (Cost: <span id="tower-cost">10</span>)</button>
    </div>

    <!-- JOC MINER -->
    <div id="miner" class="game">
      <h2>⛏️ Miner</h2>
      <div class="bombs-select">
        <button onclick="setBombs(1)" class="active">1 Bombă</button>
        <button onclick="setBombs(3)">3 Bombe</button>
        <button onclick="setBombs(5)">5 Bombe</button>
        <button onclick="setBombs(10)">10 Bombe</button>
      </div>
      <div id="miner-grid"></div>
      <div class="miner-controls">
        <button id="start-miner">Start Miner (Cost: <span id="miner-cost">10</span>)</button>
        <button id="cash-out-miner" disabled>Cash Out</button>
      </div>
    </div>

    <!-- JOC CROSSY -->
    <div id="crossy" class="game">
      <h2>🐸 Crossy Road</h2>
      <div class="message" id="crossy-message">Apasă Start pentru a juca!</div>
      <div id="crossy-path"></div>
      <div class="crossy-controls">
        <button id="left-btn" disabled>⬅️ Stânga</button>
        <button id="right-btn" disabled>Dreapta ➡️</button>
      </div>
      <div>Potential Câștig: <span id="crossy-win">0</span> monede</div>
      <button id="start-crossy">Start Crossy (Cost: <span id="crossy-cost">10</span>)</button>
      <button id="cash-out-crossy" disabled>Cash Out</button>
    </div>

    <!-- JOC BLACKJACK -->
    <div id="blackjack" class="game">
      <h2>🃏 BlackJack</h2>
      <div id="bj-message" style="margin: 10px 0; min-height: 20px; color: #ffcc00;"></div>
      
      <div style="margin: 15px 0;">
        <strong>Dealer:</strong>
        <div id="dealer-cards" style="display: flex; flex-wrap: wrap; gap: 5px; margin: 5px 0;"></div>
        <div>Total Dealer: <span id="dealer-total">?</span></div>
      </div>

      <div style="margin: 15px 0;">
        <strong>Jucător:</strong>
        <div id="player-cards" style="display: flex; flex-wrap: wrap; gap: 5px; margin: 5px 0;"></div>
        <div>Total Jucător: <span id="player-total">0</span></div>
      </div>

      <div id="bj-controls">
        <button id="bj-hit" disabled>Hit</button>
        <button id="bj-stand" disabled>Stand</button>
        <button id="bj-deal">Deal (Pariu: <span id="bj-bet-display">10</span>)</button>
      </div>
    </div>

    <!-- JOC POKER -->
    <div id="poker" class="game">
      <h2>🃟 Video Poker</h2>
      <div id="poker-message">Apasă Deal pentru a începe!</div>
      
      <div id="poker-cards" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; margin: 15px 0;"></div>
      
      <div id="poker-controls">
        <button id="deal-poker">Deal (Cost: <span id="poker-bet-display">10</span>)</button>
        <button id="draw-poker" disabled>Draw</button>
      </div>
    </div>

    <!-- Resetare + Susținere -->
    <div style="text-align:center; margin:20px 0;">
      <button id="reset" style="background:#555;">🔄 Resetare progres</button>
      <button id="support" style="background:#ff4444;">❤️ Support Author</button>
      <button id="support2" style="background:#4444ff;">❤️ Support the author's wife</button>
    </div>

    <footer>
      <div>✨ Toate jocurile rulează local în browser!</div>
      <div>📅 2025 FunCasino - Jocuri gratuite</div>
    </footer>
  </div>

  <script>
    // 🔧 Stocare Locală & Inițializare
    let coins = parseInt(localStorage.getItem('funCasinoCoins')) || 1000;
    let currentBet = 10;
    let historyCrush = JSON.parse(localStorage.getItem('crushHistory')) || [];
    
    // 🔗 Înlocuiește cu link-ul tău!
    const instagramLink = "https://www.instagram.com/cri.sti__";
    // 🔗 Înlocuiește cu link-ul celei de-al doilea persoane!
    const instagramLink2 = "https://www.instagram.com/__danny.ella";

    // --- ELEMENTE ---
    const coinDisplay = document.getElementById('coins');
    const betDisplay = document.getElementById('bet');
    const messageBox = document.getElementById('message');
    const customBetInput = document.getElementById('custom-bet');
    
    // --- FUNCȚII GENERALE ---
    function updateCoins() {
      coinDisplay.textContent = coins;
      localStorage.setItem('funCasinoCoins', coins);
    }
    
    function updateBetDisplay() {
      betDisplay.textContent = currentBet;
      document.querySelectorAll('#spin-cost, #crush-cost, #tower-cost, #miner-cost, #crossy-cost, #drop-cost, #bj-bet-display, #poker-bet-display').forEach(el => {
          if (el.id === 'drop-cost') {
              el.textContent = currentBet;
          } else if (el.id === 'bj-bet-display' || el.id === 'poker-bet-display') {
              el.textContent = currentBet;
          } else {
              el.textContent = currentBet;
          }
      });
    }

    function setBet(amount) {
      if (amount > 0) currentBet = amount;
      updateBetDisplay();
      messageBox.textContent = `Pariu setat: ${currentBet} monede`;
      setTimeout(() => {
        if (messageBox.textContent === `Pariu setat: ${currentBet} monede`) {
          messageBox.textContent = "";
        }
      }, 2000);
    }

    function applyCustomBet() {
      const val = parseInt(customBetInput.value);
      if (val && val > 0 && val <= 10000) {
        setBet(val);
      } else {
        messageBox.innerHTML = `<span style="color:#f55">Pariu invalid!</span>`;
        setTimeout(() => { messageBox.textContent = ""; }, 2000);
      }
    }

    // --- FUNCȚII JOCURI ---
    // - Comutare Jocuri -
    function switchGame(gameId) {
      document.querySelectorAll('.game').forEach(game => game.classList.remove('active-game'));
      document.getElementById(gameId).classList.add('active-game');
      
      document.querySelectorAll('.game-selector-sidebar button').forEach(b => b.classList.remove('active'));
      const sidebarButtons = document.querySelectorAll('.game-selector-sidebar button');
      for (let button of sidebarButtons) {
        if (button.textContent.includes(
          gameId === 'slots' ? 'Sloturi' :
          gameId === 'plinko' ? 'Plinko' :
          gameId === 'crush' ? 'Crush' :
          gameId === 'tower' ? 'Tower' :
          gameId === 'miner' ? 'Miner' :
          gameId === 'crossy' ? 'Crossy' :
          gameId === 'blackjack' ? 'BlackJack' :
          'Poker' 
        )) {
          button.classList.add('active');
          break;
        }
      }
      
      if (window.innerWidth <= 600) {
        document.getElementById('game-sidebar').style.display = 'none';
      }
    }
    
    // - Meniu Toggle -
    function toggleGameMenu() {
      const sidebar = document.getElementById('game-sidebar');
      sidebar.style.display = sidebar.style.display === 'flex' ? 'none' : 'flex';
    }

    // - ISTORIC CRUSH -
    function updateCrushHistory() {
      const hist = document.getElementById('crush-history');
      hist.innerHTML = '';
      [...historyCrush.slice(-10)].reverse().forEach(x => {
        const item = document.createElement('div');
        item.className = x <= 1.0 ? 'history-item crash' : 'history-item';
        item.textContent = `${x.toFixed(3)}x`;
        hist.appendChild(item);
      });
    }
    updateCrushHistory();

    // - SLOTURI -
    const symbols = ['🍒', '🍋', '🍉', '🍇', '🍊', '🔔', '💎', '7️⃣'];
    const reels = [
      document.getElementById('r1'),
      document.getElementById('r2'),
      document.getElementById('r3')
    ];
    const spinButton = document.getElementById('spin');
    let isSpinning = false;

    spinButton.addEventListener('click', () => {
      if (isSpinning || coins < currentBet) {
        messageBox.innerHTML = `<span style="color:#f55">Fonduri insuficiente!</span>`;
        return;
      }
      isSpinning = true;
      coins -= currentBet;
      updateCoins();
      messageBox.textContent = "Rotire...";
      
      let spins = 0;
      const maxSpins = 20;
      const spinInterval = setInterval(() => {
        reels.forEach(reel => {
          reel.textContent = symbols[Math.floor(Math.random() * symbols.length)];
        });
        spins++;
        if (spins > maxSpins) {
          clearInterval(spinInterval);
          isSpinning = false;
          
          const r1 = reels[0].textContent;
          const r2 = reels[1].textContent;
          const r3 = reels[2].textContent;
          let win = 0;
          
          if (r1 === r2 && r2 === r3) {
            win = r1 === '7️⃣' ? 50 : r1 === '💎' ? 30 : 10;
          } else if (r1 === r2 || r1 === r3 || r2 === r3) {
            win = 2;
          }
          
          win = Math.floor(win * currentBet);
          if (win > 0) {
            coins += win;
            messageBox.innerHTML = `<span style="color:#0f0">🎉 Câștig: +${win} monede!</span>`;
          } else {
            messageBox.innerHTML = `<span style="color:#f55">Ai pierdut ${currentBet} monede.</span>`;
          }
          updateCoins();
        }
      }, 100);
    });

    // - PLINKO - Versiune Actualizată -
    const board = document.getElementById('plinko-board');
    const slotsContainer = document.getElementById('plinko-slots');
    const dropButton = document.getElementById('drop');
    const BALL_RADIUS = 7;
    const PEG_RADIUS = 5;
    const ROWS = 12;
    const COLS = 9;
    const ROW_SPACING = 35;
    const COL_SPACING = 35;
    let plinkoBallCount = 1;
    let isDropping = false;

    function createPegs() {
      board.innerHTML = '';
      const boardWidth = board.clientWidth || 300;
      const boardHeight = board.clientHeight || 500;
      
      for (let row = 0; row < ROWS; row++) {
        const pegsInRow = row % 2 === 0 ? COLS : COLS - 1;
        const rowWidth = (pegsInRow - 1) * COL_SPACING;
        const rowStartX = (boardWidth - rowWidth) / 2;
        const y = 50 + row * ROW_SPACING;
        
        for (let col = 0; col < pegsInRow; col++) {
          const x = rowStartX + col * COL_SPACING;
          const peg = document.createElement('div');
          peg.className = 'peg';
          peg.style.left = `${x - PEG_RADIUS}px`;
          peg.style.top = `${y - PEG_RADIUS}px`;
          board.appendChild(peg);
        }
      }
      
      slotsContainer.innerHTML = '';
      const plinkoValues = [0.2, 0.5, 1, 2, 5, 2, 1, 0.5, 0.2];
      const slotStartX = (boardWidth - (plinkoValues.length - 1) * COL_SPACING) / 2;
      
      plinkoValues.forEach((val, index) => {
        const slot = document.createElement('div');
        slot.style.width = `${COL_SPACING}px`;
        slot.style.marginLeft = index === 0 ? `${slotStartX}px` : '0';
        slot.style.marginRight = index === plinkoValues.length - 1 ? `${slotStartX}px` : '0';
        slot.textContent = val;
        slot.style.color = val > 2 ? '#0f0' : val < 1 ? '#aaa' : '#ffcc00';
        slotsContainer.appendChild(slot);
      });
    }

    function applyPlinkoBalls() {
      const val = parseInt(document.getElementById('plinko-balls').value);
      if (val && val > 0) plinkoBallCount = val;
    }

    dropButton.addEventListener('click', () => {
      if (isDropping || coins < currentBet * plinkoBallCount) {
        messageBox.innerHTML = `<span style="color:#f55">Fonduri insuficiente pentru ${plinkoBallCount} bile!</span>`;
        return;
      }
      isDropping = true;
      coins -= currentBet * plinkoBallCount;
      updateCoins();
      messageBox.textContent = `Arunc ${plinkoBallCount} bile...`;
      
      let ballsDone = 0;
      for (let b = 0; b < plinkoBallCount; b++) {
        setTimeout(() => {
          const ball = document.createElement('div');
          ball.className = 'ball';
          const boardWidth = board.clientWidth || 300;
          const startX = boardWidth / 2 - BALL_RADIUS;
          ball.style.left = `${startX}px`;
          ball.style.top = `${-BALL_RADIUS * 2}px`;
          board.appendChild(ball);
          
          let ballX = startX + BALL_RADIUS;
          let ballY = -BALL_RADIUS;
          let velX = (Math.random() - 0.5) * 4;
          let velY = 0;
          
          const ballInterval = setInterval(() => {
            ballY += velY;
            ballX += velX;
            velY += 0.2;
            
            if (ballY > (board.clientHeight || 500)) {
              clearInterval(ballInterval);
              
              const slotIndex = Math.min(Math.max(Math.floor((ballX - (boardWidth - (9-1)*COL_SPACING)/2) / COL_SPACING), 0), 8);
              const plinkoValues = [0.2, 0.5, 1, 2, 5, 2, 1, 0.5, 0.2];
              const win = Math.floor(plinkoValues[slotIndex] * currentBet);
              
              coins += win;
              updateCoins();
              board.removeChild(ball);
              ballsDone++;
              
              if (ballsDone === plinkoBallCount) {
                messageBox.innerHTML = `<span style="color:#0f0">🎉 Ai câștigat ${win * plinkoBallCount} monede în total!</span>`;
                isDropping = false;
              }
            } else {
              ball.style.top = `${ballY - BALL_RADIUS}px`;
              ball.style.left = `${ballX - BALL_RADIUS}px`;
              
              const pegs = document.querySelectorAll('.peg');
              pegs.forEach(peg => {
                const pegRect = peg.getBoundingClientRect();
                const boardRect = board.getBoundingClientRect();
                const pegX = pegRect.left - boardRect.left + PEG_RADIUS;
                const pegY = pegRect.top - boardRect.top + PEG_RADIUS;
                
                const dx = ballX - pegX;
                const dy = ballY - pegY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < BALL_RADIUS + PEG_RADIUS) {
                  const angle = Math.atan2(dy, dx);
                  velX = Math.cos(angle) * 3;
                  velY = Math.sin(angle) * 3;
                }
              });
            }
          }, 15);
        }, b * 300);
      }
    });

    window.addEventListener('load', createPegs);
    window.addEventListener('resize', createPegs);

    // - CRUSH - Ritm Modificat și Bug Reparat -
    const plane = document.getElementById('plane');
    const multiplierDisplay = document.getElementById('multiplier-display');
    const explosion = document.getElementById('explosion');
    const startCrush = document.getElementById('start-crush');
    const cashOut = document.getElementById('cash-out');
    let isCrushing = false;
    let crushStartTime;
    let crushAnimationFrameId;
    const MAX_MULTIPLIER = 1000000; // Limită maximă pentru multiplicator

    startCrush.addEventListener('click', () => {
      if (isCrushing || coins < currentBet) {
        messageBox.innerHTML = `<span style="color:#f55">Fonduri insuficiente!</span>`;
        return;
      }
      isCrushing = true;
      coins -= currentBet;
      updateCoins();
      messageBox.textContent = "Zboară... dar explodează oricând!";
      explosion.style.display = 'none';
      plane.style.transform = 'rotate(0deg)';
      multiplierDisplay.textContent = '1.000x';
      cashOut.disabled = false;
      crushStartTime = Date.now();

      function updateCrush(timestamp) {
        if (!isCrushing) return;

        const elapsedTimeMs = timestamp - crushStartTime;
        // Asigurăm că elapsedTimeMs nu este negativ și că multiplicatorul nu depășește limita
        const elapsedTimePositive = Math.max(0, elapsedTimeMs);
        let newMultiplierValue = 1.000 + (elapsedTimePositive * 0.001);
        newMultiplierValue = Math.min(newMultiplierValue, MAX_MULTIPLIER); // Limitare

        multiplierDisplay.textContent = newMultiplierValue.toFixed(3) + 'x';
        plane.style.transform = `rotate(${(newMultiplierValue - 1) * 20}deg)`; // Rotație avion

        // Șansă de explozie - ajustată pentru a fi mai realistă
        if (Math.random() < 0.00002 + (newMultiplierValue * 0.0000005)) {
          isCrushing = false;
          cancelAnimationFrame(crushAnimationFrameId);
          explosion.style.display = 'block';
          const xValue = parseFloat(multiplierDisplay.textContent);
          historyCrush.push(xValue);
          if (historyCrush.length > 50) historyCrush.shift();
          localStorage.setItem('crushHistory', JSON.stringify(historyCrush));
          updateCrushHistory();
          messageBox.innerHTML = `<span style="color:#f00">💥 Explode la ${xValue.toFixed(3)}x! Ai pierdut!</span>`;
          cashOut.disabled = true;
          return;
        }

        crushAnimationFrameId = requestAnimationFrame(updateCrush);
      }

      crushAnimationFrameId = requestAnimationFrame(updateCrush);
    });

    cashOut.addEventListener('click', () => {
      if (!isCrushing) return;
      isCrushing = false;
      cancelAnimationFrame(crushAnimationFrameId);
      const elapsedTimeMs = Date.now() - crushStartTime;
      const elapsedTimePositive = Math.max(0, elapsedTimeMs);
      const winMultiplier = 1.000 + (elapsedTimePositive * 0.001);
      const winMultiplierCapped = Math.min(winMultiplier, MAX_MULTIPLIER); // Limitare la cashout
      const win = Math.floor(currentBet * winMultiplierCapped);
      coins += win;
      updateCoins();
      messageBox.innerHTML = `<span style="color:#0f0">✅ Cash Out la ${winMultiplierCapped.toFixed(3)}x! +${win} monede!</span>`;
      cashOut.disabled = true;
    });

    // - TOWER - Modificat pentru a fi mai compact și mișcare pas cu pas -
    let towerDifficulty = 'easy';
    const towerGrid = document.getElementById('tower-grid');
    let towerCurrentStep = 0; // Pasul curent în Tower
    let towerPath = []; // Stocăm pozițiile sigure pentru fiecare rând

    function setTowerDiff(diff) {
      towerDifficulty = diff;
      document.querySelectorAll('.difficulty button').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
    }

    document.getElementById('start-tower').addEventListener('click', () => {
      if (coins < currentBet) {
        messageBox.textContent = "Fonduri insuficiente!";
        return;
      }
      coins -= currentBet;
      updateCoins();
      towerGrid.innerHTML = '';
      towerCurrentStep = 0;
      towerPath = [];
      
      const rows = 8;
      let cols, bombsPerRow, safePathsPerRow;
      
      if (towerDifficulty === 'easy') {
        cols = 3;
        bombsPerRow = 1;
        safePathsPerRow = 1; // Redus de la 2 la 1
      } else if (towerDifficulty === 'medium') {
        cols = 4;
        bombsPerRow = 2;
        safePathsPerRow = 1; // Redus de la 2 la 1
      } else {
        cols = 5;
        bombsPerRow = 3;
        safePathsPerRow = 1; // Redus de la 2 la 1
      }
      
      towerGrid.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
      
      // Generăm întregul traseu în avans
      for (let row = 0; row < rows; row++) {
        const safePositions = [];
        while (safePositions.length < safePathsPerRow) {
          const pos = Math.floor(Math.random() * cols);
          if (!safePositions.includes(pos)) safePositions.push(pos);
        }
        towerPath.push(safePositions[0]); // Alegem prima poziție sigură pentru acest rând
      }
      
      // Cream grila cu toate celulele ascunse
      for (let row = 0; row < rows; row++) {
        for (let col = 0; col < cols; col++) {
          const cell = document.createElement('div');
          cell.className = 'tower-cell';
          cell.dataset.row = row;
          cell.dataset.col = col;
          cell.dataset.revealed = 'false';
          cell.dataset.type = 'unknown'; // Nu știm ce e
          
          cell.addEventListener('click', function() {
            // Poți face doar un pas la rândul curent
            const clickedRow = parseInt(this.dataset.row);
            if (clickedRow !== towerCurrentStep) {
                messageBox.textContent = "Poți merge doar pe rândul curent!";
                return;
            }
            
            if (this.dataset.revealed === 'true') return; // Nu poți face click de 2 ori pe aceeași celulă
            
            this.dataset.revealed = 'true';
            
            const isSafe = (parseInt(this.dataset.col) === towerPath[clickedRow]);
            
            if (!isSafe) {
              this.classList.add('bomb');
              this.textContent = '💣';
              messageBox.innerHTML = `<span style="color:#f00">💥 Ai dat peste o bombă! Joc terminat.</span>`;
              // Deblocăm toate celulele pentru vizualizare
              document.querySelectorAll('.tower-cell').forEach(c => c.dataset.revealed = 'true');
              return;
            } else {
              this.classList.add('safe');
              this.textContent = '✅';
              towerCurrentStep++;
              
              if (towerCurrentStep >= rows) {
                // Ai ajuns la final
                this.classList.add('bonus');
                this.textContent = '💰';
                const win = Math.floor(currentBet * (2 + Math.random() * 3));
                coins += win;
                messageBox.innerHTML = `<span style="color:#0f0">🎉 Ai ajuns la final! +${win} monede!</span>`;
                updateCoins();
                // Deblocăm toate celulele pentru vizualizare
                document.querySelectorAll('.tower-cell').forEach(c => c.dataset.revealed = 'true');
              } else {
                messageBox.textContent = "Ai ales calea corectă! Continuă la următorul rând.";
              }
            }
          });
          
          towerGrid.appendChild(cell);
        }
      }
    });

    // - MINER - Modificat pentru blocare după pierdere și recompense ajustate -
    let bombCount = 1;
    const minerGrid = document.getElementById('miner-grid');
    let safeFound = 0;
    const xValues = { 1: 1.5, 3: 2, 5: 2.5, 10: 3, 15: 3.5, 20: 4, 24: 5 }; // Multiplicatori mai mici

    function setBombs(count) {
      bombCount = count;
      document.querySelectorAll('.bombs-select button').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
    }

    document.getElementById('start-miner').addEventListener('click', () => {
      if (coins < currentBet) {
        messageBox.textContent = "Fonduri insuficiente!";
        return;
      }
      coins -= currentBet;
      updateCoins();
      minerGrid.innerHTML = '';
      safeFound = 0;
      document.getElementById('cash-out-miner').disabled = true;
      
      const totalCells = 36;
      const bombs = new Set();
      while (bombs.size < bombCount) {
        bombs.add(Math.floor(Math.random() * totalCells));
      }
      
      for (let i = 0; i < totalCells; i++) {
        const cell = document.createElement('div');
        cell.className = 'miner-cell';
        cell.textContent = '💎';
        cell.dataset.index = i;
        cell.dataset.bomb = bombs.has(i) ? 'true' : 'false';
        cell.dataset.shown = 'false';
        
        cell.addEventListener('click', function() {
          if (this.dataset.shown === 'true') return;
          this.dataset.shown = 'true';
          
          if (this.dataset.bomb === 'true') {
            this.classList.add('bomb');
            this.textContent = '💣';
            messageBox.innerHTML = `<span style="color:#f00">💥 Ai dat peste o bombă!</span>`;
            document.getElementById('cash-out-miner').disabled = true;
            // Blochează toate celulele după pierdere
            document.querySelectorAll('.miner-cell').forEach(c => {
                c.classList.add('disabled');
                if (c.dataset.bomb === 'true' && c.dataset.shown !== 'true') {
                    c.classList.add('bomb');
                    c.textContent = '💣';
                } else if (c.dataset.shown !== 'true') {
                    c.classList.add('safe');
                    c.textContent = '💎';
                }
            });
          } else {
            this.classList.add('safe');
            this.textContent = '✅';
            safeFound++;
            document.getElementById('cash-out-miner').disabled = false;
          }
        });
        
        minerGrid.appendChild(cell);
      }
    });

    document.getElementById('cash-out-miner').onclick = () => {
      const multiplier = xValues[bombCount] || 1;
      // Recompensa este bazată pe numărul de celule sigure găsite și dificultate
      const win = Math.floor(currentBet * multiplier * (safeFound / 10)); // Scalat de la 10 celule sigure
      coins += win;
      updateCoins();
      messageBox.innerHTML = `<span style="color:#0f0">✅ Ai salvat comoara! +${win} monede!</span>`;
      document.getElementById('cash-out-miner').disabled = true;
      // Blochează toate celulele după cashout
      document.querySelectorAll('.miner-cell').forEach(c => {
          c.classList.add('disabled');
          if (c.dataset.bomb === 'true' && c.dataset.shown !== 'true') {
              c.classList.add('bomb');
              c.textContent = '💣';
          } else if (c.dataset.shown !== 'true') {
              c.classList.add('safe');
              c.textContent = '💎';
          }
      });
    };

    // - CROSSY -
    let crossyGameActive = false;
    let crossyCurrentStep = 0;
    let crossyPath = [];
    const crossyMessage = document.getElementById('crossy-message');
    const crossyPathDisplay = document.getElementById('crossy-path');
    const leftBtn = document.getElementById('left-btn');
    const rightBtn = document.getElementById('right-btn');
    const startCrossyBtn = document.getElementById('start-crossy');
    const cashOutCrossyBtn = document.getElementById('cash-out-crossy');
    const crossyWinDisplay = document.getElementById('crossy-win');

    function createCrossyPath(step) {
      crossyPathDisplay.innerHTML = '';
      crossyPath = [];
      const pathLength = 5;
      const correctPosition = Math.floor(Math.random() * 3); // 0, 1, sau 2
      
      for (let i = 0; i < pathLength; i++) {
        const segment = document.createElement('div');
        if (i < step) {
          segment.textContent = '🐸'; // Sau imaginea găinii, dacă o ai
        } else if (i === step) {
          segment.textContent = ['⬅️', '⏺️', '➡️'][correctPosition];
          crossyPath.push(correctPosition);
        } else {
          const randPos = Math.floor(Math.random() * 3);
          segment.textContent = ['⬅️', '⏺️', '➡️'][randPos];
          crossyPath.push(randPos);
        }
        crossyPathDisplay.appendChild(segment);
      }
    }

    function enableCrossyButtons() {
      leftBtn.disabled = false;
      rightBtn.disabled = false;
    }

    function disableCrossyButtons() {
      leftBtn.disabled = true;
      rightBtn.disabled = true;
    }

    function startCrossyGame() {
      if (crossyGameActive || coins < currentBet) {
        crossyMessage.innerHTML = `<span style="color:#f55">Fonduri insuficiente!</span>`;
        return;
      }
      crossyGameActive = true;
      coins -= currentBet;
      updateCoins();
      crossyCurrentStep = 0;
      crossyMessage.innerHTML = `Alege direcția! Alege pentru pasul ${crossyCurrentStep + 1}.`;
      createCrossyPath(crossyCurrentStep);
      crossyWinDisplay.textContent = Math.floor(currentBet * Math.pow(1.5, crossyCurrentStep + 1));
      setTimeout(enableCrossyButtons, 500);
      startCrossyBtn.disabled = true;
      cashOutCrossyBtn.disabled = false;
    }

    leftBtn.addEventListener('click', () => makeCrossyChoice(0));
    rightBtn.addEventListener('click', () => makeCrossyChoice(2));

    function makeCrossyChoice(choice) {
      disableCrossyButtons();
      const correctChoice = crossyPath[crossyCurrentStep];
      
      if (choice === correctChoice) {
        crossyMessage.innerHTML = `<span style="color:#0f0">✅ Corect! Continuă...</span>`;
        crossyCurrentStep++;
        crossyWinDisplay.textContent = Math.floor(currentBet * Math.pow(1.5, crossyCurrentStep + 1));
        
        setTimeout(() => {
          if (crossyCurrentStep >= 5) {
            const win = Math.floor(currentBet * Math.pow(1.5, crossyCurrentStep));
            coins += win;
            updateCoins();
            crossyMessage.innerHTML = `<span style="color:#0f0">🎉 Ai terminat nivelul! +${win} monede!</span>`;
            endCrossyGame();
          } else {
            crossyMessage.innerHTML = `Alege direcția! Alege pentru pasul ${crossyCurrentStep + 1}.`;
            createCrossyPath(crossyCurrentStep);
            setTimeout(enableCrossyButtons, 500);
          }
        }, 600);
      } else {
        crossyMessage.innerHTML = `<span style="color:#f00">💥 Ai fost lovit! Ai pierdut pariul.</span>`;
        endCrossyGame();
      }
    }

    function endCrossyGame() {
      crossyGameActive = false;
      crossyWinDisplay.textContent = '';
      startCrossyBtn.disabled = false;
      disableCrossyButtons();
      cashOutCrossyBtn.disabled = true;
    }

    startCrossyBtn.addEventListener('click', startCrossyGame);
    cashOutCrossyBtn.addEventListener('click', () => {
      if (!crossyGameActive) return;
      const win = Math.floor(currentBet * Math.pow(1.5, crossyCurrentStep));
      coins += win;
      updateCoins();
      crossyMessage.innerHTML = `<span style="color:#0f0">✅ Ai ieșit! +${win} monede!</span>`;
      endCrossyGame();
    });

    // - BLACKJACK - Reducerea Egalităților -
    let bjDeck = [];
    let bjPlayerHand = [];
    let bjDealerHand = [];
    let bjGameActive = false;

    const bjMessage = document.getElementById('bj-message');
    const dealerCardsEl = document.getElementById('dealer-cards');
    const playerCardsEl = document.getElementById('player-cards');
    const dealerTotalEl = document.getElementById('dealer-total');
    const playerTotalEl = document.getElementById('player-total');
    const hitButton = document.getElementById('bj-hit');
    const standButton = document.getElementById('bj-stand');
    const dealButton = document.getElementById('bj-deal');

    function createDeck() {
        const suits = ['hearts', 'diamonds', 'clubs', 'spades'];
        const values = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
        const deck = [];
        for (let suit of suits) {
            for (let value of values) {
                deck.push({ suit, value });
            }
        }
        return deck;
    }

    function shuffleDeck(deck) {
        for (let i = deck.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [deck[i], deck[j]] = [deck[j], deck[i]];
        }
    }

    function getCardValue(card) {
        if (['J', 'Q', 'K'].includes(card.value)) return 10;
        if (card.value === 'A') return 11;
        return parseInt(card.value);
    }

    function calculateHandValue(hand) {
        let value = 0;
        let aces = 0;
        for (let card of hand) {
            value += getCardValue(card);
            if (card.value === 'A') aces++;
        }
        while (value > 21 && aces > 0) {
            value -= 10;
            aces--;
        }
        return value;
    }

    function displayCard(card, container, hidden = false) {
        const cardEl = document.createElement('div');
        cardEl.className = 'card';
        if (hidden) {
            cardEl.classList.add('hidden-card');
            cardEl.textContent = '?';
        } else {
            cardEl.textContent = `${card.value}${card.suit === 'hearts' ? '♥' : card.suit === 'diamonds' ? '♦' : card.suit === 'clubs' ? '♣' : '♠'}`;
            if (card.suit === 'hearts' || card.suit === 'diamonds') {
                cardEl.style.color = 'red';
            }
        }
        container.appendChild(cardEl);
    }

    function startBJGame() {
        if (bjGameActive || coins < currentBet) {
            bjMessage.textContent = "Fonduri insuficiente!";
            return;
        }
        bjGameActive = true;
        coins -= currentBet;
        updateCoins();
        bjMessage.textContent = "Joc nou început!";
        bjDeck = createDeck();
        shuffleDeck(bjDeck);
        bjPlayerHand = [];
        bjDealerHand = [];
        dealerCardsEl.innerHTML = '';
        playerCardsEl.innerHTML = '';
        playerTotalEl.textContent = '0';
        dealerTotalEl.textContent = '?';

        bjPlayerHand.push(bjDeck.pop());
        bjDealerHand.push(bjDeck.pop());
        bjPlayerHand.push(bjDeck.pop());
        bjDealerHand.push(bjDeck.pop());

        displayCard(bjPlayerHand[0], playerCardsEl);
        displayCard(bjPlayerHand[1], playerCardsEl);
        displayCard(bjDealerHand[0], dealerCardsEl);
        displayCard(bjDealerHand[1], dealerCardsEl, true);

        playerTotalEl.textContent = calculateHandValue(bjPlayerHand);

        if (calculateHandValue(bjPlayerHand) === 21) {
             bjMessage.textContent = "Blackjack! Așteaptă dealerul...";
             setTimeout(dealerPlay, 1000);
        } else {
            hitButton.disabled = false;
            standButton.disabled = false;
        }
        dealButton.disabled = true;
    }

    function playerHit() {
        if (!bjGameActive) return;
        const newCard = bjDeck.pop();
        bjPlayerHand.push(newCard);
        displayCard(newCard, playerCardsEl);
        const playerValue = calculateHandValue(bjPlayerHand);
        playerTotalEl.textContent = playerValue;

        if (playerValue > 21) {
            bjMessage.textContent = "Ai depășit 21! Ai pierdut.";
            endBJGame();
        } else if (playerValue === 21) {
            bjMessage.textContent = "Ai 21! Așteaptă dealerul...";
            playerStand();
        }
    }

    function playerStand() {
        if (!bjGameActive) return;
        hitButton.disabled = true;
        standButton.disabled = true;
        bjMessage.textContent = "Dealerul joacă...";
        setTimeout(dealerPlay, 1000);
    }

    function dealerPlay() {
        dealerCardsEl.innerHTML = '';
        displayCard(bjDealerHand[0], dealerCardsEl);
        displayCard(bjDealerHand[1], dealerCardsEl);
        let dealerValue = calculateHandValue(bjDealerHand);
        dealerTotalEl.textContent = dealerValue;

        const dealerInterval = setInterval(() => {
            if (dealerValue < 17) {
                const newCard = bjDeck.pop();
                bjDealerHand.push(newCard);
                displayCard(newCard, dealerCardsEl);
                dealerValue = calculateHandValue(bjDealerHand);
                dealerTotalEl.textContent = dealerValue;
                
                if (dealerValue > 21) {
                    clearInterval(dealerInterval);
                    bjMessage.textContent = "Dealerul a depășit 21! Ai câștigat!";
                    coins += currentBet * 2;
                    updateCoins();
                    endBJGame();
                }
            } else {
                clearInterval(dealerInterval);
                setTimeout(determineBJWinner, 500);
            }
        }, 1000);
    }

    // Funcție modificată pentru a reduce egalitățile
    function determineBJWinner() {
        const playerValue = calculateHandValue(bjPlayerHand);
        const dealerValue = calculateHandValue(bjDealerHand);

        if (playerValue > 21) {
            bjMessage.textContent = "Ai depășit 21! Ai pierdut.";
        } else if (dealerValue > 21) {
            bjMessage.textContent = "Dealerul a depășit 21! Ai câștigat!";
        } else if (playerValue > dealerValue) {
            bjMessage.textContent = "Ai câștigat!";
            coins += currentBet * 2;
            updateCoins();
        } else if (playerValue < dealerValue) {
            bjMessage.textContent = "Dealerul câștigă.";
        } else {
            // Reducem șansele de egalitate prin introducerea unui "tie-breaker"
            // De exemplu, dacă amândoi au aceeași valoare, dealerul câștigă în 60% din cazuri
            if (Math.random() < 0.6) { // 60% șanse dealer, 40% push
                 bjMessage.textContent = "Dealerul câștigă (Tie-breaker).";
            } else {
                 bjMessage.textContent = "Egalitate (Push). Pariul este returnat.";
                 coins += currentBet;
                 updateCoins();
            }
        }
        endBJGame();
    }

    function endBJGame() {
        bjGameActive = false;
        hitButton.disabled = true;
        standButton.disabled = true;
        dealButton.disabled = false;
    }

    dealButton.addEventListener('click', startBJGame);
    hitButton.addEventListener('click', playerHit);
    standButton.addEventListener('click', playerStand);

    // - POKER - Joc Simplu de Video Poker -
    let pokerDeck = [];
    let pokerHand = [];
    let pokerGameActive = false;
    let heldCards = [false, false, false, false, false]; // Pentru a ține evidența cărților păstrate

    const pokerMessage = document.getElementById('poker-message');
    const pokerCardsEl = document.getElementById('poker-cards');
    const dealPokerButton = document.getElementById('deal-poker');
    const drawPokerButton = document.getElementById('draw-poker');

    function createPokerDeck() {
        const suits = ['hearts', 'diamonds', 'clubs', 'spades'];
        const values = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
        const deck = [];
        for (let suit of suits) {
            for (let value of values) {
                deck.push({ suit, value });
            }
        }
        return deck;
    }

    function shufflePokerDeck(deck) {
        for (let i = deck.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [deck[i], deck[j]] = [deck[j], deck[i]];
        }
    }

    function displayPokerCard(card, index, container) {
        const cardEl = document.createElement('div');
        cardEl.className = 'card';
        cardEl.dataset.index = index; // Adăugăm indexul pentru a identifica cardul
        cardEl.textContent = `${card.value}${card.suit === 'hearts' ? '♥' : card.suit === 'diamonds' ? '♦' : card.suit === 'clubs' ? '♣' : '♠'}`;
        if (card.suit === 'hearts' || card.suit === 'diamonds') {
            cardEl.style.color = 'red';
        }
        
        // Adăugăm eveniment de click pentru a păstra cardul
        cardEl.addEventListener('click', () => {
            if (pokerGameActive && !heldCards[index]) {
                heldCards[index] = true;
                cardEl.style.borderColor = '#ffcc00'; // Bordură galbenă pentru card păstrat
                cardEl.style.boxShadow = '0 0 10px #ffcc00';
            } else if (pokerGameActive && heldCards[index]) {
                // Dacă deja e păstrat, îl eliberăm
                heldCards[index] = false;
                cardEl.style.borderColor = '#333';
                cardEl.style.boxShadow = 'none';
            }
        });
        
        container.appendChild(cardEl);
    }

    function getPokerHandName(hand) {
        // Simplificăm logica pentru un exemplu de bază
        const values = hand.map(card => card.value);
        const suits = hand.map(card => card.suit);
        const valueCounts = {};
        values.forEach(v => valueCounts[v] = (valueCounts[v] || 0) + 1);
        const counts = Object.values(valueCounts).sort((a, b) => b - a);
        const isFlush = new Set(suits).size === 1;
        const sortedValues = values.map(v => isNaN(v) ? ({'J': 11, 'Q': 12, 'K': 13, 'A': 14}[v]) : parseInt(v)).sort((a, b) => a - b);
        const isStraight = sortedValues.every((v, i) => i === 0 || v === sortedValues[i - 1] + 1) || 
                           (sortedValues.join(',') === '2,3,4,5,14'); // Straight cu Ass

        if (isStraight && isFlush && sortedValues[0] === 10) return { name: "Royal Flush", payout: 250 };
        if (isStraight && isFlush) return { name: "Straight Flush", payout: 50 };
        if (counts[0] === 4) return { name: "Four of a Kind", payout: 25 };
        if (counts[0] === 3 && counts[1] === 2) return { name: "Full House", payout: 9 };
        if (isFlush) return { name: "Flush", payout: 6 };
        if (isStraight) return { name: "Straight", payout: 4 };
        if (counts[0] === 3) return { name: "Three of a Kind", payout: 3 };
        if (counts[0] === 2 && counts[1] === 2) return { name: "Two Pair", payout: 2 };
        if (counts[0] === 2 && ['J', 'Q', 'K', 'A'].includes(values.find(v => valueCounts[v] === 2))) return { name: "Jacks or Better", payout: 1 };
        return { name: "Nimic", payout: 0 };
    }

    function startPokerGame() {
        if (pokerGameActive || coins < currentBet) {
            pokerMessage.textContent = "Fonduri insuficiente!";
            return;
        }
        pokerGameActive = true;
        coins -= currentBet;
        updateCoins();
        pokerMessage.textContent = "Alege cărțile de păstrat și apoi Draw!";
        pokerDeck = createPokerDeck();
        shufflePokerDeck(pokerDeck);
        pokerHand = [];
        heldCards = [false, false, false, false, false];
        pokerCardsEl.innerHTML = '';

        // Împarte primele 5 cărți
        for (let i = 0; i < 5; i++) {
            pokerHand.push(pokerDeck.pop());
        }

        pokerHand.forEach((card, index) => {
            displayPokerCard(card, index, pokerCardsEl);
        });

        dealPokerButton.disabled = true;
        drawPokerButton.disabled = false;
    }

    function drawPokerCards() {
        if (!pokerGameActive) return;

        // Înlocuiește cărțile ne-păstrate
        for (let i = 0; i < 5; i++) {
            if (!heldCards[i]) {
                pokerHand[i] = pokerDeck.pop();
            }
        }

        // Re-afișează toate cărțile
        pokerCardsEl.innerHTML = '';
        pokerHand.forEach((card, index) => {
            displayPokerCard(card, index, pokerCardsEl);
            // Resetăm stilul pentru cărțile păstrate
            if (heldCards[index]) {
                const cardEl = pokerCardsEl.children[index];
                cardEl.style.borderColor = '#ffcc00';
                cardEl.style.boxShadow = '0 0 10px #ffcc00';
            }
        });

        // Determină câștigul
        const handResult = getPokerHandName(pokerHand);
        const win = Math.floor(currentBet * handResult.payout);
        
        if (win > 0) {
            coins += win;
            pokerMessage.innerHTML = `<span style="color:#0f0">🎉 ${handResult.name}! +${win} monede!</span>`;
        } else {
            pokerMessage.innerHTML = `<span style="color:#f55">Nimic. Ai pierdut pariul.</span>`;
        }
        
        updateCoins();
        endPokerGame();
    }

    function endPokerGame() {
        pokerGameActive = false;
        dealPokerButton.disabled = false;
        drawPokerButton.disabled = true;
    }

    dealPokerButton.addEventListener('click', startPokerGame);
    drawPokerButton.addEventListener('click', drawPokerCards);

    // - RESETARE -
    document.getElementById('reset').addEventListener('click', () => {
      if (confirm("Resetare totală a progresului?")) {
        coins = 1000;
        historyCrush = [];
        localStorage.removeItem('funCasinoCoins');
        localStorage.removeItem('crushHistory');
        updateCoins();
        updateCrushHistory();
        messageBox.textContent = "✅ Joc resetat!";
        towerDifficulty = 'easy';
        document.querySelectorAll('.difficulty button').forEach(b => b.classList.remove('active'));
        document.querySelector('.difficulty button').classList.add('active');
      }
    });

    // - SUSȚINERE AUTOR -
    document.getElementById('support').addEventListener('click', () => {
      window.open(instagramLink, '_blank');
    });
    
    document.getElementById('support2').addEventListener('click', () => {
      window.open(instagramLink2, '_blank');
    });
    
    // - BUTON HOME -
    document.getElementById('home-btn').addEventListener('click', () => {
      switchGame('slots');
      messageBox.textContent = "Bun venit înapoi la pagina principală!";
    });

    // Inițializare
    updateCoins();
    updateBetDisplay();
    createPegs();
    
    // Actualizăm afișajul pariului pentru BJ și Poker
    function updateBJBetDisplay() {
         document.getElementById('bj-bet-display').textContent = currentBet;
    }
    function updatePokerBetDisplay() {
         document.getElementById('poker-bet-display').textContent = currentBet;
    }
    const originalSetBet = setBet;
    setBet = function(amount) {
        originalSetBet(amount);
        updateBJBetDisplay();
        updatePokerBetDisplay();
    };
    const originalApplyCustomBet = applyCustomBet;
    applyCustomBet = function() {
        originalApplyCustomBet();
        updateBJBetDisplay();
        updatePokerBetDisplay();
    };
  </script>
</body>
</html>